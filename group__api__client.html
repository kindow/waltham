<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Waltham: Client API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Waltham
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Client API</div>  </div>
</div><!--header-->
<div class="contents">

<p>Common and exclusive API for clients.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__api__common"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__api__common.html">Common API for both server and client</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga92558808e3c20da42ed44fc2d540da07"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="classwth__connection.html">wth_connection</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__api__client.html#ga92558808e3c20da42ed44fc2d540da07">wth_connection::wth_connect_to_server</a> (const char *host, const char *port)</td></tr>
<tr class="memdesc:ga92558808e3c20da42ed44fc2d540da07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to a remote Waltham server.  <a href="#ga92558808e3c20da42ed44fc2d540da07">More...</a><br /></td></tr>
<tr class="separator:ga92558808e3c20da42ed44fc2d540da07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga402f82228a650f0c93ebf8fb4bcbcb0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__api__client.html#ga402f82228a650f0c93ebf8fb4bcbcb0c">wth_connection::wth_connection_roundtrip</a> (struct <a class="el" href="classwth__connection.html">wth_connection</a> *conn)</td></tr>
<tr class="memdesc:ga402f82228a650f0c93ebf8fb4bcbcb0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a roundtrip from a client.  <a href="#ga402f82228a650f0c93ebf8fb4bcbcb0c">More...</a><br /></td></tr>
<tr class="separator:ga402f82228a650f0c93ebf8fb4bcbcb0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71482299a4e8a68a8a1f3c5b574d10ab"><td class="memItemLeft" align="right" valign="top">struct wthp_registry *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__api__client.html#ga71482299a4e8a68a8a1f3c5b574d10ab">wth_connection::wth_connection_create_registry</a> (struct <a class="el" href="classwth__connection.html">wth_connection</a> *conn)</td></tr>
<tr class="memdesc:ga71482299a4e8a68a8a1f3c5b574d10ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new registry using the internal wth_display.  <a href="#ga71482299a4e8a68a8a1f3c5b574d10ab">More...</a><br /></td></tr>
<tr class="separator:ga71482299a4e8a68a8a1f3c5b574d10ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61f841e989c611a23220b710ff62da43"><td class="memItemLeft" align="right" valign="top">struct wthp_callback *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__api__client.html#ga61f841e989c611a23220b710ff62da43">wth_connection::wth_connection_sync</a> (struct <a class="el" href="classwth__connection.html">wth_connection</a> *conn)</td></tr>
<tr class="memdesc:ga61f841e989c611a23220b710ff62da43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a callback using the internal wth_display.  <a href="#ga61f841e989c611a23220b710ff62da43">More...</a><br /></td></tr>
<tr class="separator:ga61f841e989c611a23220b710ff62da43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Common and exclusive API for clients. </p>
<p>These functions are exclusive to a client. They will abort the program if called in the context of a server-side <a class="el" href="classwth__connection.html" title="A Waltham connection. ">wth_connection</a>. For the common functions, see <a class="el" href="group__api__common.html">Common API for both server and client</a>. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga92558808e3c20da42ed44fc2d540da07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga92558808e3c20da42ed44fc2d540da07">&#9670;&nbsp;</a></span>wth_connect_to_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="classwth__connection.html">wth_connection</a> * wth_connect_to_server </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect to a remote Waltham server. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">host</td><td>The address of the server. </td></tr>
    <tr><td class="paramname">port</td><td>The port of the server. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new connection, or NULL on failure.</dd></dl>
<p>This creates a client-side <a class="el" href="classwth__connection.html" title="A Waltham connection. ">wth_connection</a>, making a connection to a remote Waltham server.</p>
<p>On failure, errno is set.</p>
<p>XXX: This call may block. We should find a way to make this a non-blocking operation, so that if the connection fails to form, we get an error back from read and flush etc. </p>

</div>
</div>
<a id="ga71482299a4e8a68a8a1f3c5b574d10ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga71482299a4e8a68a8a1f3c5b574d10ab">&#9670;&nbsp;</a></span>wth_connection_create_registry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct wthp_registry * wth_connection_create_registry </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="classwth__connection.html">wth_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new registry using the internal wth_display. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>The Waltham connection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new registry object.</dd></dl>
<p>The returned registry can then be used to retrieve other global objects, using its usual interface. </p>

</div>
</div>
<a id="ga402f82228a650f0c93ebf8fb4bcbcb0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga402f82228a650f0c93ebf8fb4bcbcb0c">&#9670;&nbsp;</a></span>wth_connection_roundtrip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wth_connection_roundtrip </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="classwth__connection.html">wth_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make a roundtrip from a client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>The Waltham connection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure.</dd></dl>
<p>This is a helper for creating a wthp_callback object by sending wth_display.sync request, and waiting for the callback to trigger. As such, it is only usable for clients.</p>
<p>This call blocks indefinitely until the roundtrip completes or the connection fails. It will flush outgoing and dispatch incoming messages until it returns.</p>
<p>On failure, use <a class="el" href="group__api__common.html#gae088971a3c3ea3ed63cc9875fd4f751b" title="Return the connection error state. ">wth_connection_get_error()</a> to inspect the error.</p>
<p>If blocking indefinitely is not desireable or you want to be able to process other file descriptors in the mean time, you have to write your own roundtrip implementation using the public API. </p>

</div>
</div>
<a id="ga61f841e989c611a23220b710ff62da43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61f841e989c611a23220b710ff62da43">&#9670;&nbsp;</a></span>wth_connection_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct wthp_callback * wth_connection_sync </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="classwth__connection.html">wth_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a callback using the internal wth_display. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>The Waltham connection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new callback object.</dd></dl>
<p>The returned callback will emit a 'done' event once the server has seen all preceding requests. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
